{% extends "base.html" %}
{% block title %}Map View{% endblock %}
{% block head %}
  <link href="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.css" rel="stylesheet" />
  <style>
    #map {
      width: 100%;
      height: 500px;
      border: 1px solid #ddd;
      margin-top: 20px;
    }
  </style>
{% endblock %}
{% block content %}
<h2>Map View: {{ box }}</h2>
<div id="map"></div>
<a href="{{ url_for('user_dashboard') }}" class="btn btn-primary mt-3">Back to Dashboard</a>
{% endblock %}
{% block scripts %}
<script src="https://api.mapbox.com/mapbox-gl-js/v2.15.0/mapbox-gl.js"></script>
<script>
  mapboxgl.accessToken = "{{ mapbox_token }}";

  const map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox://styles/mapbox/streets-v11',
    center: [{{ coords[0].lon }}, {{ coords[0].lat }}],
    zoom: 12
  });

  const marker = new mapboxgl.Marker()
    .setLngLat([{{ coords[0].lon }}, {{ coords[0].lat }}])
    .setPopup(new mapboxgl.Popup().setHTML(`<strong>Box:</strong> {{ box }}`))
    .addTo(map);
</script>
{% endblock %}
